services:
  # Blynk
  blynk:
    build:
      context: blynk-server-0.41.17
      network: host

    image: alexeytsarev/blynk-server:0.41.17
    container_name: blynk
    network_mode: host
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    environment:
      - TERM=xterm
      - BLYNK_CONFIG=config/server.properties
      #- DEBUG=1
      #- WAIT_FOR=127.0.0.1:5432 # Wait for Postgres
      #- WAIT_FOR_TIMEOUT=60 # Wait for Postgres

    labels:
      - SERVICE_NAME=blynk

    logging:
      driver: journald
      options:
        tag: blynk

    volumes:
      - ${DOCKER_ROOT}/blynk/config:/opt/blynk/config:ro
      - ${DOCKER_ROOT}/blynk/data:/opt/blynk/data
      - ${DOCKER_ROOT}/log/blynk:/opt/blynk/logs
      - /etc/letsencrypt:/etc/letsencrypt:ro

    #ports:
      #- "8080:8080" # HTTP API and WebSockets server
      #- "9443:9443" # HTTPS API, WebSockets and Admin page server
      #- "8440:8440" # Mqtt hardware server

    # Override Blynk command line parameters
    #command: /blynk.sh -serverConfig new_config/server.properties
  # End Blynk


  # GitLab
  gitlab:
    image: gitlab/gitlab-ee:latest
    container_name: gitlab
    restart: unless-stopped

    labels:
      - SERVICE_NAME=gitlab

    logging:
      driver: journald
      options:
        tag: gitlab

    environment:
      GITLAB_OMNIBUS_CONFIG: |
        external_url '${GITLAB_EXTERNAL_URL}'
        gitlab_rails['gitlab_shell_ssh_port'] = 2223
        registry_external_url 'https://upru.ga:5005'
        registry_nginx['ssl_certificate'] = "/etc/letsencrypt/live/upru.ga/fullchain.pem"
        registry_nginx['ssl_certificate_key'] = "/etc/letsencrypt/live/upru.ga/privkey.pem"

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /etc/letsencrypt:/etc/letsencrypt:ro
      - ${DOCKER_ROOT}/gitlab/config:/etc/gitlab
      - ${DOCKER_ROOT}/gitlab/data:/var/opt/gitlab
      - ${DOCKER_ROOT}/log/gitlab:/var/log/gitlab

    ports:
      - "2223:22"
      - "8082:80"
      - "7443:443"
      - "5005:5005"
  # End GitLab


  # GitLab Runner
  gitlab-runner:
    image: gitlab/gitlab-runner:latest
    container_name: gitlab-runner
    network_mode: host
    restart: unless-stopped

    labels:
      - SERVICE_NAME=gitlab-runner

    logging:
      driver: journald
      options:
        tag: gitlab-runner

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /var/run/docker.sock:/var/run/docker.sock
      - ${DOCKER_ROOT}/gitlab-runner/config:/srv/gitlab-runner/config
  # End GitLab Runner


  # Ivideon
  ivideon:
    #build:
    #  context: ivideon-3.9.0
    #  network: host

    image: alexeytsarev/ivideon:3.9.0
    container_name: ivideon
    network_mode: host
    restart: unless-stopped
    init: true

    # environment variables:
    # gui=0 (or "gui" variable not provided) - Start Ivideon Server only. Run GUI manually: docker exec -ti ivideon /ivideon.sh gui
    # gui=1                                  - Start Ivideon Server and GUI
    environment:
      - TERM=xterm
      #- gui=1 # See comments above

    labels:
      - SERVICE_NAME=ivideon

    logging:
      driver: journald
      options:
        tag: ivideon

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/ivideon_archive:/mnt/archive
      - ${DOCKER_ROOT}/ivideon:/root/.IvideonServer # Comment this during initial startup. This keeps Ivideon settings. Uncomment after initial configuration and configs copy

    #ports:
      #- "8080:8080"
      #- "3101:3101"
      #- "443:443"
      #- "80:80
  # End Ivideon"


  # Apache 2.4, php 5.6
  ap56:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php5.6 php5.6-common php5.6-cli php5.6-curl php5.6-intl php5.6-mbstring php5.6-bcmath php5.6-gd php5.6-pgsql php5.6-mysql php5.6-json php5.6-zip php5.6-xml php5.6-opcache php5.6-xmlrpc php5.6-mcrypt

    image: alexeytsarev/apache_php:2.4_5.6
    container_name: ap56
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap56

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap56/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap56
  # End Apache 2.4, php 5.6


  # Apache 2.4, php 7.0
  ap70:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php7.0 php7.0-common php7.0-cli php7.0-curl php7.0-intl php7.0-mbstring php7.0-bcmath php7.0-gd php7.0-pgsql php7.0-mysql php7.0-json php7.0-zip php7.0-xml php7.0-opcache php7.0-xmlrpc php7.0-mcrypt

    image: alexeytsarev/apache_php:2.4_7.0
    container_name: ap70
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap70

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap70/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap70
  # End Apache 2.4, php 7.0


  # Apache 2.4, php 7.1
  ap71:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php7.1 php7.1-common php7.1-cli php7.1-curl php7.1-intl php7.1-mbstring php7.1-bcmath php7.1-gd php7.1-pgsql php7.1-mysql php7.1-json php7.1-zip php7.1-xml php7.1-opcache php7.1-xmlrpc php7.1-mcrypt

    image: alexeytsarev/apache_php:2.4_7.1
    container_name: ap71
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap71

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap71/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap71
  # End Apache 2.4, php 7.1


  # Apache 2.4, php 7.2
  ap72:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php7.2 php7.2-common php7.2-cli php7.2-curl php7.2-intl php7.2-mbstring php7.2-bcmath php7.2-gd php7.2-pgsql php7.2-mysql php7.2-json php7.2-zip php7.2-xml php7.2-opcache php7.2-xmlrpc

    image: alexeytsarev/apache_php:2.4_7.2
    container_name: ap72
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap72

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap72/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap72
  # End Apache 2.4, php 7.2


  # Apache 2.4, php 7.3
  ap73:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php7.3 php7.3-common php7.3-cli php7.3-curl php7.3-intl php7.3-mbstring php7.3-bcmath php7.3-gd php7.3-pgsql php7.3-mysql php7.3-json php7.3-zip php7.3-xml php7.3-opcache php7.3-xmlrpc

    image: alexeytsarev/apache_php:2.4_7.3
    container_name: ap73
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap73

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap73/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap73
  # End Apache 2.4, php 7.3


  # Apache 2.4, php 7.4
  ap74:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php7.4 php7.4-common php7.4-cli php7.4-curl php7.4-intl php7.4-mbstring php7.4-bcmath php7.4-gd php7.4-pgsql php7.4-mysql php7.4-json php7.4-zip php7.4-xml php7.4-opcache php7.4-xmlrpc

    image: alexeytsarev/apache_php:2.4_7.4
    container_name: ap74
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap74

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap74/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap74
  # End Apache 2.4, php 7.4


  # Apache 2.4, php 8.0
  ap80:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.0 php8.0-common php8.0-cli php8.0-curl php8.0-intl php8.0-mbstring php8.0-bcmath php8.0-gd php8.0-pgsql php8.0-mysql php8.0-zip php8.0-xml php8.0-opcache

    image: alexeytsarev/apache_php:2.4_8.0
    container_name: ap80
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap80

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap80/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap80
  # End Apache 2.4, php 8.0


  # Apache 2.4, php 8.1
  ap81:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.1 php8.1-common php8.1-cli php8.1-curl php8.1-intl php8.1-mbstring php8.1-bcmath php8.1-gd php8.1-pgsql php8.1-mysql php8.1-zip php8.1-xml php8.1-opcache

    image: alexeytsarev/apache_php:2.4_8.1
    container_name: ap81
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap81

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap81/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap81
  # End Apache 2.4, php 8.1


  # Apache 2.4, php 8.2
  ap82:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.2 php8.2-common php8.2-cli php8.2-curl php8.2-intl php8.2-mbstring php8.2-bcmath php8.2-gd php8.2-pgsql php8.2-mysql php8.2-zip php8.2-xml php8.2-opcache

    image: alexeytsarev/apache_php:2.4_8.2
    container_name: ap82
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap82

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap82/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap82
  # End Apache 2.4, php 8.2


  # Apache 2.4, php 8.3
  ap83:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.3 php8.3-common php8.3-cli php8.3-curl php8.3-intl php8.3-mbstring php8.3-bcmath php8.3-gd php8.3-pgsql php8.3-mysql php8.3-zip php8.3-xml php8.3-opcache

    image: alexeytsarev/apache_php:2.4_8.3
    container_name: ap83
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap83

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap83/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap83
  # End Apache 2.4, php 8.3


  # Apache 2.4, php 8.4
  ap84:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.4 php8.4-common php8.4-cli php8.4-curl php8.4-intl php8.4-mbstring php8.4-bcmath php8.4-gd php8.4-pgsql php8.4-mysql php8.4-zip php8.4-xml php8.4-opcache

    image: alexeytsarev/apache_php:2.4_8.4
    container_name: ap84
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap84

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap84/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap84
  # End Apache 2.4, php 8.4


  # Apache 2.4, php 8.5
  ap85:
    build:
      context: apache-2.4_php-x.y
      network: host
      args:
        - PHP_PACKAGES=php8.5 php8.5-common php8.5-cli php8.5-curl php8.5-intl php8.5-mbstring php8.5-bcmath php8.5-gd php8.5-pgsql php8.5-mysql php8.5-zip php8.5-xml

    image: alexeytsarev/apache_php:2.4_8.5
    container_name: ap85
    restart: unless-stopped

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=ap85

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - ${DOCKER_ROOT}/apache/sites-enabled/:/etc/apache2/sites-enabled/:ro
      - ${DOCKER_ROOT}/log/ap85/:/var/log/apache2/

    logging:
      driver: journald
      options:
        tag: ap85
  # End Apache 2.4, php 8.5


  # Nginx stable
  # https://nginx.org/en/download.html
  nginx-stable:
    build:
      context: nginx_and_forks-x.y.z
      network: host
      args:
        - APP_NAME=nginx-stable
        - APP_SHORT=nginx
        - APP_VERSION=1.28.2
        - APP_SRC_URL=https://nginx.org/download/nginx-1.28.2.tar.gz

    image: alexeytsarev/nginx:1.28.2
    container_name: nginx-stable
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"
      #- "443:443"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=nginx-stable

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      #- ${DOCKER_ROOT}/nginx-stable/sites-enabled/:/opt/nginx/conf/sites-enabled/
      #- ${DOCKER_ROOT}/nginx-stable/acme.cfg:/acme.cfg
      #- ${DOCKER_ROOT}/cert/:/opt/cert/
      #- ${DOCKER_ROOT}/log/nginx-stable/:/opt/nginx/log/
      #- /home:/home

    logging:
      driver: journald
      options:
        tag: nginx-stable
  # End Nginx stable


  # Nginx mainline
  # https://nginx.org/en/download.html
  nginx-mainline:
    build:
      context: nginx_and_forks-x.y.z
      network: host
      args:
        - APP_NAME=nginx-mainline
        - APP_SHORT=nginx
        - APP_VERSION=1.29.5
        - APP_SRC_URL=https://nginx.org/download/nginx-1.29.5.tar.gz

    image: alexeytsarev/nginx:1.29.5
    container_name: nginx-mainline
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"
      #- "443:443"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=nginx-mainline

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      #- ${DOCKER_ROOT}/nginx-mainline/sites-enabled/:/opt/nginx/conf/sites-enabled/
      #- ${DOCKER_ROOT}/nginx-mainline/acme.cfg:/acme.cfg
      #- ${DOCKER_ROOT}/cert/:/opt/cert/
      #- ${DOCKER_ROOT}/log/nginx-mainline/:/opt/nginx/log/
      #- /home:/home

    logging:
      driver: journald
      options:
        tag: nginx-mainline
  # End Nginx mainline


  # Nginx legacy
  # https://nginx.org/en/download.html
  nginx-legacy:
    build:
      context: nginx_and_forks-x.y.z
      network: host
      args:
        - APP_NAME=nginx-legacy
        - APP_SHORT=nginx
        - APP_VERSION=1.26.3
        - APP_SRC_URL=https://nginx.org/download/nginx-1.26.3.tar.gz

    image: alexeytsarev/nginx:1.26.3
    container_name: nginx-legacy
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"
      #- "443:443"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=nginx-legacy

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      #- ${DOCKER_ROOT}/nginx-legacy/sites-enabled/:/opt/nginx/conf/sites-enabled/
      #- ${DOCKER_ROOT}/nginx-legacy/acme.cfg:/acme.cfg
      #- ${DOCKER_ROOT}/cert/:/opt/cert/
      #- ${DOCKER_ROOT}/log/nginx-legacy/:/opt/nginx/log/
      #- /home:/home

    logging:
      driver: journald
      options:
        tag: nginx-legacy
  # End Nginx legacy


  # Tengine
  # https://github.com/alibaba/tengine/releases
  tengine:
    build:
      context: nginx_and_forks-x.y.z
      network: host
      args:
        - APP_NAME=tengine
        - APP_SHORT=tengine
        - APP_VERSION=3.1.0
        - APP_SRC_URL=https://github.com/alibaba/tengine/archive/refs/tags/3.1.0.tar.gz
        - CONFIGURE_OPTS=--with-jemalloc
        - PKGS_BUILDTIME=libjemalloc2 libjemalloc-dev
        - PKGS_RUNTIME=libjemalloc2

    image: alexeytsarev/tengine:3.1.0
    container_name: tengine
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    #network_mode: host
    network_mode: bridge
    #ports:
      #- "80:80"
      #- "443:443"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=tengine

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      #- ${DOCKER_ROOT}/tengine/sites-enabled/:/opt/tengine/conf/sites-enabled/
      #- ${DOCKER_ROOT}/tengine/acme.cfg:/acme.cfg
      #- ${DOCKER_ROOT}/cert/:/opt/cert/
      #- ${DOCKER_ROOT}/log/tengine/:/opt/nginx/log/
      #- /home:/home

    logging:
      driver: journald
      options:
        tag: tengine
  # End Tengine


  # MariaDB
  mariadb:
    build:
      context: mariadb-11.8
      network: host

    image: alexeytsarev/mariadb:11.8
    container_name: mysql
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - MYSQL_USER
      - MYSQL_MAX_CONNECTIONS
      - MYSQL_RUN_BEFORE
      - MYSQL_LISTEN_PORT=3306

    labels:
      - SERVICE_NAME=mysql

    logging:
      driver: journald
      options:
        tag: mysql

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /run/mysqld/:/run/mysqld/
      - /tmp/:/tmp/
      - ${DOCKER_ROOT}/mysql/:/etc/mysql/
      - ${DOCKER_ROOT}/mysql_db/:/var/lib/mysql/
      - ${DOCKER_ROOT}/log/mysql/:/var/log/mysql/

    #ports:
      #- "3306:3306"
  # End MariaDB


  # vsftpd
  vsftpd:
    build:
      context: vsftpd-3.0.5
      network: host

    image: alexeytsarev/vsftpd:3.0.5
    container_name: vsftpd
    restart: unless-stopped
    init: true

    network_mode: host
    #network_mode: bridge
    #ports:
    #- "21:21"

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=vsftpd

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/shadow:/etc/shadow:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /home:/home
      - ${DOCKER_ROOT}/vsftpd:/etc/vsftpd
      - ${DOCKER_ROOT}/log/vsftpd:/var/log/vsftpd

    logging:
      driver: journald
      options:
        tag: vsftpd
  # End vsftpd


  # Fail2Ban
  fail2ban:
    build:
      context: fail2ban-1.1.0
      network: host

    image: alexeytsarev/fail2ban:1.1.0
    container_name: fail2ban
    privileged: true
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - FAIL2BAN_PRE_EXEC

    labels:
      - SERVICE_NAME=fail2ban

    logging:
      driver: journald
      options:
        tag: fail2ban

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /lib/modules:/lib/modules
      - /var/log:/var/log
      - ${DOCKER_ROOT}/log/fail2ban:/var/log/fail2ban
      - ${DOCKER_ROOT}/log/nginx:/var/log/nginx:ro
      - ${DOCKER_ROOT}/log/ap56:/var/log/httpd56:ro
      - ${DOCKER_ROOT}/log/ap70:/var/log/httpd70:ro
      - ${DOCKER_ROOT}/log/ap71:/var/log/httpd71:ro
      - ${DOCKER_ROOT}/log/ap72:/var/log/httpd72:ro
      - ${DOCKER_ROOT}/log/ap73:/var/log/httpd73:ro
      - ${DOCKER_ROOT}/log/ap74:/var/log/httpd74:ro
      - ${DOCKER_ROOT}/log/ap80:/var/log/httpd80:ro
      - ${DOCKER_ROOT}/log/ap81:/var/log/httpd81:ro
      - ${DOCKER_ROOT}/log/ap82:/var/log/httpd82:ro
      - ${DOCKER_ROOT}/log/ap83:/var/log/httpd83:ro
      - ${DOCKER_ROOT}/log/ap84:/var/log/httpd84:ro
      - ${DOCKER_ROOT}/log/ap85:/var/log/httpd85:ro
      #- ${DOCKER_ROOT}/fail2ban/jail.local:/etc/fail2ban/jail.local:ro # If you have a config

      #depends_on:
      #- nginx
      #- ap56
      #- ap70
      #- ap71
      #- ap72
      #- ap73
      #- ap74
      #- ap80
      #- ap81
      #- ap82
      #- ap83
      #- ap84
      #- ap85
  # End Fail2Ban


#  # Consul
#  consul:
#    build:
#      context: consul-1.6.1
#      network: host
#
#    image: alexeytsarev/consul:1.6.1
#    container_name: consul
#    network_mode: host
#    restart: unless-stopped
#    init: true
#
#    environment:
#      - TERM=xterm
#      #- CONSUL_ADVERTISE_PUBLIC_IP=10
#      - CONSUL_ADVERTISE_FIRST_IP
#      #- DEBUG=1
#
#    command: -server -ui
#    #command: -server -ui -bootstrap
#    #command: -server -ui -advertise=\'{{ GetInterfaceIP \"eth0\" }}\'
#    #command: -server -ui -bootstrap -advertise=\'{{ GetInterfaceIP \"eth0\" }}\'
#
#    labels:
#      - SERVICE_NAME=consul
#
#    logging:
#      driver: journald
#      options:
#        tag: consul
#
#    volumes:
#      - /etc/timezone:/etc/timezone:ro
#      - /etc/localtime:/etc/localtime:ro
#      - ${DOCKER_ROOT}/consul/data:/etc/consul/data
#      - ${DOCKER_ROOT}/consul/config:/etc/consul/config
#
#    ports:
#      - "8300:8300"               # Server RPC    (Default 8300). This is used by servers to handle incoming requests from other agents. TCP only.
#      - "8301:8301"               # Serf LAN      (Default 8301). This is used to handle gossip in the LAN. Required by all agents. TCP and UDP.
#      - "8301:8301/udp"
#      - "8302:8302"               # Serf WAN      (Default 8302). This is used by servers to gossip over the WAN to other servers. TCP and UDP.
#      - "8302:8302/udp"
#      - "127.0.0.1:8500:8500"     # HTTP API      (Default 8500). This is used by clients to talk to the HTTP API. TCP only.
#      - "127.0.0.1:8600:8600"     # DNS Interface (Default 8600). Used to resolve DNS queries. TCP and UDP.
#      - "127.0.0.1:8600:8600/udp"
#  # End Consul


#  # Registrator
#  registrator:
#    image: gliderlabs/registrator:latest
#    container_name: registrator
#    network_mode: host
#    restart: unless-stopped
#
#    environment:
#      - TERM=xterm
#
#    command: consul://127.0.0.1:8500
#
#    labels:
#      - SERVICE_NAME=registrator
#
#    logging:
#      driver: journald
#      options:
#        tag: registrator
#
#    volumes:
#      - /etc/timezone:/etc/timezone:ro
#      - /etc/localtime:/etc/localtime:ro
#      - /var/run/docker.sock:/tmp/docker.sock
#
#    depends_on:
#      - consul
#  # End Registrator


  # sshd
  sshd:
    build:
      context: sshd-10.0
      network: host
      args:
        - PACKAGES=msmtp curl wget

    image: alexeytsarev/sshd:10.0
    container_name: sshd
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - SSHD_OPTS=-e -p 2222
      - PRE_CMD=[ ! -f /bin/bash-2222 ] && set -x && cd /bin && ln -s bash bash-2222 && { set +x; } 2>/dev/null

    labels:
      - SERVICE_NAME=sshd

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/shadow:/etc/shadow:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /etc/locale.gen:/etc/locale.gen:ro
      - /home:/home:ro
      - ${BACKUP_ROOT}/backup:/backup
      - ${BACKUP_ROOT}/backup_storage:/backup_storage

    logging:
      driver: journald
      options:
        tag: sshd

    #ports:
      #- "2222:2222"
  # End sshd


  # sslh
  # https://github.com/yrutschle/sslh?tab=readme-ov-file#docker-image
  sslh:
    # https://github.com/yrutschle/sslh/pkgs/container/sslh
    image: ghcr.io/yrutschle/sslh:latest
    container_name: sslh
    # privileged: true
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined
    cap_add:
      - NET_ADMIN
      - NET_RAW
      - NET_BIND_SERVICE

    network_mode: host
    #network_mode: bridge
    #ports:
    #- "443:443"

    # must be set manually
    # sysctls:
    #  - net.ipv4.conf.default.route_localnet=1
    #  - net.ipv4.conf.all.route_localnet=1

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=sslh

    logging:
      driver: journald
      options:
        tag: sslh

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro

    #entrypoint: ""
    #command: sleep inf

    command: --foreground --transparent --numeric --listen=0.0.0.0:443 --ssh 127.0.0.1:22 --tls=127.0.0.1:8443 --openvpn=127.0.0.1:1194
  # End sslh


  # traccar
  traccar:
    image: traccar/traccar:6.6-debian
    container_name: traccar
    network_mode: host
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    environment:
      - TERM=xterm

    labels:
      - SERVICE_NAME=traccar

    logging:
      driver: journald
      options:
        tag: traccar

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/traccar:/opt/traccar/conf
      - ${DOCKER_ROOT}/log/traccar:/opt/traccar/logs:rw

    #ports:
      #- "5000-5150:5000-5150"
      #- "5000-5150:5000-5150/udp"
      #- "8082:8082"
  # End traccar


  # utorrent
  utorrent:
    #build:
    #  context: utorrent-server-3.3
    #  network: host

    image: alexeytsarev/utorrent-server:3.3
    container_name: utorrent
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - UTORRENT_USER
      - UTORRENT_GROUP

    labels:
      - SERVICE_NAME=utorrent

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/log/utorrent:/opt/utorrent/log
      - ${DOCKER_ROOT}/utorrent/data:/opt/utorrent/data
      - ${DOCKER_ROOT}/utorrent/data_in:/opt/utorrent/data_in
      - ${DOCKER_ROOT}/utorrent/data_out:/opt/utorrent/data_out
      - ${DOCKER_ROOT}/utorrent/torrents:/opt/utorrent/torrents
      - ${DOCKER_ROOT}/utorrent/settings:/opt/utorrent/settings

    logging:
      driver: journald
      options:
        tag: utorrent
  # End utorrent


  # rakshasa/rTorrent
  rtorrent:
    build:
      context: rtorrent-0.15.5
      network: host

    image: alexeytsarev/rtorrent:0.15.5
    container_name: rtorrent
    network_mode: host
    #privileged: true
    stop_grace_period: 30s
    restart: unless-stopped

    environment:
      - TERM=xterm
      - RTORRENT_USER
      - RTORRENT_GROUP
      - RTORRENT_HTTP_LISTEN_PORT
      - RTORRENT_HTTP_ALIAS

    labels:
      - SERVICE_NAME=rtorrent

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/log/rtorrent:/opt/rtorrent/log
      - ${DOCKER_ROOT}/rtorrent/.rtorrent.rc:/opt/rtorrent/.rtorrent.rc
      - ${DOCKER_ROOT}/rtorrent/.session:/opt/rtorrent/.session
      - ${DOCKER_ROOT}/rtorrent/data:/opt/rtorrent/data
      - ${DOCKER_ROOT}/rtorrent/watch/load:/opt/rtorrent/watch/load
      - ${DOCKER_ROOT}/rtorrent/watch/start:/opt/rtorrent/watch/start

    logging:
      driver: journald
      options:
        tag: rtorrent
  # End rakshasa/rTorrent


  # stickz/rTorrent
  rtorrent-fork:
    build:
      context: rtorrent-7.2-0.9.8-0.13.8
      network: host

    image: alexeytsarev/rtorrent-fork:7.2-0.9.8-0.13.8
    container_name: rtorrent-fork
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - RTORRENT_USER
      - RTORRENT_GROUP

    labels:
      - SERVICE_NAME=rtorrent-fork

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /var/www/html/ruTorrent:/var/www/html/ruTorrent
      - /var/www/tmp:/var/www/tmp
      - ${DOCKER_ROOT}/log/rtorrent:/opt/rtorrent/log
      - ${DOCKER_ROOT}/rtorrent/.rtorrent.rc:/opt/rtorrent/.rtorrent.rc
      - ${DOCKER_ROOT}/rtorrent/.session:/opt/rtorrent/.session
      - ${DOCKER_ROOT}/rtorrent/data:/opt/rtorrent/data
      - ${DOCKER_ROOT}/rtorrent/watch/load:/opt/rtorrent/watch/load
      - ${DOCKER_ROOT}/rtorrent/watch/start:/opt/rtorrent/watch/start

    logging:
      driver: journald
      options:
        tag: rtorrent
  # End stickz/rTorrent


  # crazymax/rTorrent
  rtorrent-crazymax:
    image: crazymax/rtorrent-rutorrent:5.2.9-0.15.4
    container_name: rtorrent-crazymax
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - RUTORRENT_PORT=8890

    labels:
      - SERVICE_NAME=rtorrent-crazymax

    volumes:
      - /docker/rtorrent-crazymax/data:/data
      - /docker/rtorrent-crazymax/downloads:/downloads
      - /docker/rtorrent-crazymax/passwd:/passwd
    logging:
      driver: journald
      options:
        tag: rtorrent-crazymax
  # End stickz/rTorrent


  # transmission
  transmission:
    build:
      context: transmission-4.1.0
      network: host
      args:
         - CLEAN=0
        # - CLEAN=1

    image: alexeytsarev/transmission:4.1.0
    container_name: transmission
    network_mode: host
    #privileged: true
    stop_grace_period: 30s
    restart: unless-stopped
    security_opt:
      - apparmor=unconfined

    environment:
      - TERM=xterm
      - FLOOD_BASE_URI=/flood
      - TRANSMISSION_USER
      - TRANSMISSION_GROUP
      - TRANSMISSION_OPTIONS=--foreground --sequential-download
      #- TRANSMISSION_OPTIONS=--foreground

    labels:
      - SERVICE_NAME=transmission

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/transmission/downloads:/opt/transmission/Downloads
      - ${DOCKER_ROOT}/transmission/config:/opt/transmission/.config
      - ${DOCKER_ROOT}/log/transmission:/opt/transmission/log
      - ${DOCKER_ROOT}/flood:/opt/flood
      - ${DOCKER_ROOT}/log/flood:/opt/flood/log

    logging:
      driver: journald
      options:
        tag: transmission
  # End transmission


  # gerbera
  gerbera:
    image: gerbera/gerbera:1.9.2
    container_name: gerbera
    network_mode: host
    restart: unless-stopped
    command: ["gerbera", "--interface", "br-vlan300", "--port", "49494", "--config", "/var/run/gerbera/config.xml"]

    environment:
      - TERM=xterm

    volumes:
      - /etc/passwd:/etc/passwd:ro
      - /etc/group:/etc/group:ro
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/gerbera:/var/run/gerbera
      - /mnt/hdd/p2p/data:/content:ro

    logging:
      driver: journald
      options:
        tag: gerbera

    #ports:
      #- "49494:49494"
      #- "1900:1900/udp"
  # End gerbera


  # wg-easy
  wg-easy:
    build:
      context: wg-easy-7
      network: host

    image: alexeytsarev/wg-easy:5
    container_name: wg-easy
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - WG_HOST
      - WG_HOST_ALIASES
      - WG_PORT=${WG_PORT:-51820}
      - PORT=${WG_UI_PORT:-51821}
      - WG_UI_PREFIX=${WG_UI_PREFIX:-/WG/}
      - PASSWORD=${WG_PASSWORD}
      - WG_POST_UP=sleep 0
      - WG_POST_DOWN=sleep 0
      - WG_DEFAULT_ADDRESS
      - WG_DEFAULT_DNS
      - SS_PREFIX
      - SS_PORT=${SS_PORT:-9999}

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/wg-easy:/etc/wireguard
      - ${DOCKER_ROOT}/nginx/sites-enabled:/opt/nginx/conf/sites-enabled

    cap_add:
      - NET_ADMIN
      - SYS_MODULE

    #sysctls:
      #- net.ipv4.conf.all.src_valid_mark=1
      #- net.ipv4.ip_forward=1

    logging:
      driver: journald
      options:
        tag: wg-easy

    #ports:
      #- "51820:51820/udp"
      #- "51821:51821"

    command: /bin/sh -c "template_envsubst.sh /opt/nginx/conf/sites-enabled/template /opt/nginx/conf/sites-enabled ; dumb-init node server.js"
  # End wg-easy


  # shadowsocks
  shadowsocks:
    build:
      context: shadowsocks-libev-3.3.5_v2ray-plugin-1.3.1
      network: host

    image: alexeytsarev/shadowsocks-libev_v2ray-plugin:3.3.5_1.3.1
    container_name: shadowsocks
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - SS_PORT=${SS_PORT:-9999}
      - SS_PASSWORD
      - SS_METHOD

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      #- ${DOCKER_ROOT}/shadowsocks-libev:/etc/shadowsocks-libev

    logging:
      driver: journald
      options:
        tag: shadowsocks

    #ports:
      #- "9999:9999"
  # End shadowsocks


  # dnscrypt-proxy
  dnscrypt-proxy:
    build:
      context: dnscrypt-proxy-2.1.15
      network: host

    image: alexeytsarev/dnscrypt-proxy:2.1.15
    container_name: dnscrypt-proxy
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro

    logging:
      driver: journald
      options:
        tag: dnscrypt-proxy
  # End dnscrypt-proxy


  # 3proxy
  3proxy:
    image: tarampampam/3proxy:latest
    container_name: 3proxy
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm
      - PROXY_LOGIN=proxy
      - PROXY_PASSWORD=proxyz3

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro

    logging:
      driver: journald
      options:
        tag: 3proxy
  # End 3proxy


  # baresip-0
  baresip-0:
    image: ghcr.io/baresip/docker/baresip:latest
    container_name: baresip-0
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm

    volumes:
      - ${DOCKER_ROOT}/baresip-0:/root/.baresip

    devices:
      - /dev/snd:/dev/snd

    logging:
      driver: journald
      options:
        tag: baresip-0
  # End baresip-0


  # baresip-1
  baresip-1:
    image: ghcr.io/baresip/docker/baresip:latest
    container_name: baresip-1
    network_mode: host
    restart: unless-stopped

    environment:
      - TERM=xterm

    volumes:
      - ${DOCKER_ROOT}/baresip-1:/root/.baresip

    devices:
      - /dev/snd:/dev/snd

    logging:
      driver: journald
      options:
        tag: baresip-1
  # End baresip-1


  # Home Assistant
  home_assistant:
    image: ghcr.io/home-assistant/home-assistant:stable
    container_name: home_assistant
    network_mode: host
    privileged: true
    restart: unless-stopped

    labels:
      - SERVICE_NAME=home_assistant

    logging:
      driver: journald
      options:
        tag: home_assistant

    volumes:
      - ${DOCKER_ROOT}/home_assistant:/config
      - /etc/localtime:/etc/localtime:ro
  # End Home Assistant


  # Grafana
  grafana:
    image: grafana/grafana
    container_name: grafana
    network_mode: host
    restart: unless-stopped

    labels:
      - SERVICE_NAME=grafana

    environment:
      GF_SERVER_ROOT_URL: http://172.22.0.99:3000
      GF_DATABASE_TYPE: postgres
      GF_DATABASE_HOST: 127.0.0.1:5432
      GF_DATABASE_NAME: grafana
      GF_DATABASE_USER: postgres
      GF_DATABASE_PASSWORD: postgres
      GF_DATABASE_SSL_MODE: disable

    volumes:
      - ${DOCKER_ROOT}/grafana:/var/lib/grafana

    logging:
      driver: journald
      options:
        tag: grafana
  # End Grafana


  # Postgres
  postgres:
    image: postgres
    container_name: postgres
    network_mode: host
    restart: always

    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres

    logging:
      driver: journald
      options:
        tag: postgres

    volumes:
      - ${DOCKER_ROOT}/postgresql:/var/lib/postgresql/data
  # End Postgres


  # Prometheus
  prometheus:
    image: prom/prometheus
    container_name: prometheus
    network_mode: host
    restart: unless-stopped

    labels:
      - SERVICE_NAME=prometheus

    volumes:
      - ${DOCKER_ROOT}/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml

    logging:
      driver: journald
      options:
        tag: prometheus
  # End Prometheus


  # VictoriaMetrics
  victoria-metrics:
    image: victoriametrics/victoria-metrics
    container_name: victoria-metrics
    network_mode: host
    restart: unless-stopped

    labels:
      - SERVICE_NAME=victoria-metrics

    logging:
      driver: journald
      options:
        tag: victoria-metrics

    volumes:
      - ${DOCKER_ROOT}/victoria-metrics/scrape.yaml:/victoria-metrics-data/scrape.yaml

    command: -promscrape.config=/victoria-metrics-data/scrape.yaml
  # End VictoriaMetrics


  # cAdvisor
  cadvisor:
    image: gcr.io/cadvisor/cadvisor
    container_name: cadvisor
    # network_mode: host
    privileged: true
    restart: unless-stopped

    logging:
      driver: journald
      options:
        tag: cadvisor

    volumes:
      - /:/rootfs:ro
      - /var/run:/var/run:ro
      - /sys:/sys:ro
      - /var/lib/docker/:/var/lib/docker:ro
      - /dev/disk/:/dev/disk:ro

    devices:
      - /dev/kmsg:/dev/kmsg
  # End cAdvisor


  # Jellyfin
  # https://jellyfin.org/docs/general/installation/container/
  jellyfin:
    # https://hub.docker.com/r/jellyfin/jellyfin/tags
    image: jellyfin/jellyfin:10.11
    container_name: jellyfin
    restart: unless-stopped
    # user: uid:gid # Optional - specify the uid and gid you would like Jellyfin to use instead of root

    network_mode: host
    #network_mode: bridge
    #ports:
      #- "8096:8096/tcp"
      #- "7359:7359/udp"

    environment:
      - JELLYFIN_PublishedServerUrl=${JELLYFIN_URL} # Optional - alternative address used for autodiscovery

    volumes:
      - ${DOCKER_ROOT}/jellyfin/config:/config
      - ${DOCKER_ROOT}/jellyfin/cache:/cache
      - type: bind
        source: /usr/share/fonts
        target: /usr/local/share/fonts/custom
        read_only: false
      # Media bindings
      - type: bind
        source: ${JELLYFIN_MEDIA1_SOURCE}
        target: ${JELLYFIN_MEDIA1_TARGET}
        read_only: true
      - type: bind
        source: ${JELLYFIN_MEDIA2_SOURCE}
        target: ${JELLYFIN_MEDIA2_TARGET}
        read_only: false

    # Optional - may be necessary for docker health check to pass if running in host network mode
    # extra_hosts:
      # - 'host.docker.internal:host-gateway'

    logging:
      driver: journald
      options:
        tag: jellyfin
  # End Jellyfin


  # OvenMediaEngine
  ome:
    # https://hub.docker.com/r/airensoft/ovenmediaengine/tags
    image: airensoft/ovenmediaengine:v0.20.0
    container_name: ome
    restart: always

    environment:
      OME_HOST_IP: ${HOST_IP}

    network_mode: host
    #network_mode: bridge
    #ports:
      #- "1935:1935"
      #- "9999:9999/udp"
      #- "9000:9000"
      #- "3333:3333"
      #- "3478:3478"
      #- "10000-10009:10000-10009/udp"

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/ome/origin_conf/:/opt/ovenmediaengine/bin/origin_conf/
      - ${DOCKER_ROOT}/ome/edge_conf/:/opt/ovenmediaengine/bin/edge_conf/
      - ${DOCKER_ROOT}/log/ome/:/var/log/ovenmediaengine/
      - /mnt/hdd/cam/:/mnt/share/default/app/

    logging:
      driver: journald
      options:
        tag: ome

    # command: sleep inf
  # End OvenMediaEngine


  # cam_streamer
  cam_streamer:
    build:
      context: cam_streamer
      network: host

    image: alexeytsarev/cam_streamer:latest
    container_name: cam_streamer
    network_mode: host
    restart: unless-stopped
    privileged: true
    security_opt:
      - apparmor=unconfined

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - /dev/snd/:/dev/snd/
      - /dev/v4l/:/dev/v4l/
      - ${DOCKER_ROOT}/cam_streamer/:/opt/cam_streamer/cfg/ # first start: comment this line: configs are needed
      - ${DOCKER_ROOT}/log/cam_streamer:/opt/cam_streamer/log/
      - /mnt/hdd/cam/:/opt/cam_streamer/store/
      # - ~/dev/cam_streamer/cam_streamer.py:/opt/cam_streamer/cam_streamer.py # debug only!

    logging:
      driver: journald
      options:
        tag: cam_streamer

    # command: sleep inf
    # command: cam_streamer.sh -log_level DEBUG
  # End cam_streamer


  # zabbix_server
  zabbix_server:
    image: zabbix/zabbix-server-mysql:ubuntu-7.0-latest
    container_name: zabbix_server
    network_mode: host
    restart: unless-stopped
    privileged: true
    #security_opt:
      #- apparmor=unconfined

    environment:
      DB_SERVER_HOST: ${ZABBIX_DB_SERVER_HOST}
      MYSQL_USER: ${ZABBIX_MYSQL_USER}
      MYSQL_PASSWORD: ${ZABBIX_MYSQL_PASSWORD}

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro

    logging:
      driver: journald
      options:
        tag: zabbix_server
  # End zabbix_server


  # zabbix_web
  zabbix_web:
    image: zabbix/zabbix-web-nginx-mysql:ubuntu-7.0-latest
    container_name: zabbix_web
    network_mode: host
    restart: unless-stopped
    privileged: true
    #security_opt:
      #- apparmor=unconfined

    healthcheck:
      test: []
      disable: true

    environment:
      DB_SERVER_HOST: ${ZABBIX_DB_SERVER_HOST}
      MYSQL_USER: ${ZABBIX_MYSQL_USER}
      MYSQL_PASSWORD: ${ZABBIX_MYSQL_PASSWORD}

    volumes:
      - /etc/timezone:/etc/timezone:ro
      - /etc/localtime:/etc/localtime:ro
      - ${DOCKER_ROOT}/zabbix/web/nginx.conf:/etc/zabbix/nginx.conf
      - ${DOCKER_ROOT}/zabbix/web/nginx_ssl.conf:/etc/zabbix/nginx_ssl.conf

    logging:
      driver: journald
      options:
        tag: zabbix_web
  # End zabbix_web
